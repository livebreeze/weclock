<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>We Clock - index</title>

	<!-- Bootstrap Core CSS -->
	<link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">

	<!-- Custom Fonts -->
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css" type="text/css">

	<!-- Plugin CSS -->
	<link rel="stylesheet" href="css/animate.min.css" type="text/css">

	<!-- Custom CSS -->
	<link rel="stylesheet" href="css/creative.css" type="text/css">

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

	<style>
		#txtWord {
			height: 200px;
			width: 500px;
		}

		.dragTarget {
			float: left;
			width: 700px;
			height: 400px;
			padding: 10px;
			border: 2px solid gray;
			margin: 10px;
		}
	</style>

</head>

<body id="page-top">

	<nav id="mainNav" class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand page-scroll" href="#page-top">WE CLOCK</a>
			</div>

			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav navbar-right">
					<li>
						<a class="page-scroll" href="#about">About</a>
					</li>
					<li>
						<a class="page-scroll" href="#Start">Start</a>
					</li>
					<li>
						<a class="page-scroll" href="#portfolio">Portfolio</a>
					</li>
					<li>
						<a class="page-scroll" href="#contact">Contact</a>
					</li>
				</ul>
			</div>
			<!-- /.navbar-collapse -->
		</div>
		<!-- /.container-fluid -->
	</nav>

	<header>
		<div class="header-content">
			<div class="header-content-inner">
				<h1>SHARING THE DAY, WAITING THE DAY, HOPING THE DAY</h1>
				<hr>
				<p>設定某一個日期，某一個時間；然後寫一段話，選一張圖，分享等待!</p>
				<a href="#about" class="btn btn-primary btn-xl page-scroll">Find Out More</a>
			</div>
		</div>
	</header>

	<section class="bg-primary" id="about">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 col-lg-offset-2 text-center">
					<h2 class="section-heading">About</h2>
					<hr class="light">
					<p class="text-faded">設定時間，寫一段話，然後送給她!</p>
					<a href="#services" class="btn btn-default btn-xl page-scroll">Get Started!</a>
				</div>
			</div>
		</div>
	</section>

	<section id="services">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 text-center">
					<h2 class="section-heading">操作流程</h2>
					<hr class="primary">
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6 text-center">
					<div class="service-box">
						<i class="fa fa-4x fa-diamond wow bounceIn text-primary"></i>
						<h3>日期時間</h3>
						<p class="text-muted">1. 設定要倒數的日期與時間</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 text-center">
					<div class="service-box">
						<i class="fa fa-4x fa-heart wow bounceIn text-primary" data-wow-delay=".3s"></i>
						<h3>想說的話</h3>
						<p class="text-muted">2. 用心節奏打一段想說的話</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 text-center">
					<div class="service-box">
						<i class="fa fa-4x fa-newspaper-o wow bounceIn text-primary" data-wow-delay=".2s"></i>
						<h3>選擇圖片</h3>
						<p class="text-muted">3. 選擇一張喜歡的圖片</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 text-center">
					<div class="service-box">
						<i class="fa fa-4x fa-paper-plane wow bounceIn text-primary" data-wow-delay=".1s"></i>
						<h3>資料儲存</h3>
						<p class="text-muted">4. 確認都填完後就送出吧！</p>
					</div>
				</div>
			</div>
		</div>
	</section>

	<section class="bg-primary" id="Start">
		<div class="container text-center">
			<div class="row">
				<div class="col-lg-8 col-lg-offset-2 text-center">
					<h2 class="section-heading">開始設定</h2>
					<hr class="light">

					<form class="form-inline" onsubmit="return false;">
						<p>
							<div class="form-group">
								<label for="txtTheDate">輸入要倒數日期時間:</label>
								<input type="datetime-local" class="form-control" id="txtTheDate" placeholder="2015/10/04 08:30:00">
								<!--<a href="#startWord" id="saveDate" class="btn btn-default btn-xl wow tada page-scroll">儲存</a>-->
							</div>
						</p>

						<p>
							<div class="form-group">
								<div>
									<span>時間設定好後</span>
									<a href="#txtWord" id="startWord" class="btn btn-default btn-xl wow tada page-scroll" style="margin:10px">點我</a>
									<span>輸入想說的話</span>

									<textarea id="txtWord" maxlength="100" class="form-control"
										oninput="wordInput(event)" disabled="disabled"
										style="margin: 10px"></textarea>
									<span>(0/100)</span>
								</div>
								<div>
									<a href="#preViewWordSection" id="preViewWord" class="btn btn-default btn-xl wow tada page-scroll">打完儲存並預覽</a>
								</div>
							</div>
						</p>
					</form>
				</div>
			</div>
		</div>
	</section>
	<section class="bg-dark" id="preViewWordSection" style="display: none">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 col-lg-offset-2 text-center">
					<p class="text-faded">
						<canvas id="surfaceWriteWords" width="600" height="400"></canvas>
					</p>
					<p class="test-faded">
						<a href="#portfolio" id="chooseImg" class="btn btn-default btn-xl wow tada page-scroll">選擇背景圖片</a>
					</p>
				</div>
			</div>
		</div>
	</section>

	<section class="no-padding" id="portfolio">
		<div class="container-fluid">
			<div class="row no-gutter">
				<div class="col-lg-4 col-sm-6">
					<img src="img/portfolio/1.jpg" id="img1" class="img-responsive" alt="" draggable="true">
				</div>
				<div class="col-lg-4 col-sm-6">
					<img src="img/portfolio/2.jpg" id="img2" class="img-responsive" alt="" draggable="true">
				</div>
				<div class="col-lg-4 col-sm-6">
					<img src="img/portfolio/3.jpg" id="img3" class="img-responsive" alt="" draggable="true">
				</div>
				<div class="col-lg-4 col-sm-6">
					<img src="img/portfolio/4.jpg" id="img4" class="img-responsive" alt="" draggable="true">
				</div>
				<div class="col-lg-4 col-sm-6">
					<img src="img/portfolio/5.jpg" id="img5" class="img-responsive" alt="" draggable="true">
				</div>
				<div class="col-lg-4 col-sm-6">
					<img src="img/portfolio/6.jpg" id="img6" class="img-responsive" alt="" draggable="true">
				</div>
			</div>
		</div>
	</section>

	<aside class="bg-dark">
		<div class="container text-center">
			<div class="call-to-action">
				<h2>把圖片拖到下面框框去!</h2>
				<div class="dragTarget">HERE! 我吃圖片！</div>
				<div>
					<a href="card.html" id="btn_exportCard" class="btn btn-default btn-xl wow tada" style="margin: 20px;">沒問題,就點我吧</a>
				</div>
			</div>
			<div class="call-to-action">
			</div>
		</div>
	</aside>
	<section id="SectionTech">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 text-center">
					<h2 class="section-heading">學習 HTML5</h2>
					<hr class="primary">
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6 text-center">
					<div class="service-box">
						<i class="fa fa-4x fa-diamond wow bounceIn text-primary"></i>
						<h3>頁面框架</h3>
						<p class="text-muted">Bootstrap Template. <a href="http://startbootstrap.com/">click me</a></p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 text-center">
					<div class="service-box">
						<i class="fa fa-4x fa-paper-plane wow bounceIn text-primary" data-wow-delay=".1s"></i>
						<h3>資料儲存</h3>
						<p class="text-muted">localStorage 離線儲存.</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 text-center">
					<div class="service-box">
						<i class="fa fa-4x fa-newspaper-o wow bounceIn text-primary" data-wow-delay=".2s"></i>
						<h3>動畫效果</h3>
						<p class="text-muted">Canvas 影像效果處理</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 text-center">
					<div class="service-box">
						<i class="fa fa-4x fa-heart wow bounceIn text-primary" data-wow-delay=".3s"></i>
						<h3>前端技術</h3>
						<p class="text-muted">HTML5, CSS3, JavaScript!</p>
					</div>
				</div>
			</div>
		</div>
	</section>
	<section id="contact">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 col-lg-offset-2 text-center">
					<h2 class="section-heading">Let's Get In Touch!</h2>
					<hr class="primary">
					<p>嗯，這是我的上課作業，有任何建議歡迎寄信給我~ ps.電話也是可以，但是應該不通</p>
				</div>
				<div class="col-lg-4 col-lg-offset-2 text-center">
					<i class="fa fa-phone fa-3x wow bounceIn"></i>
					<p>0900-123456</p>
				</div>
				<div class="col-lg-4 text-center">
					<i class="fa fa-envelope-o fa-3x wow bounceIn" data-wow-delay=".1s"></i>
					<p><a href="mailto:livebreeze@gmail.com">livebreeze@gmail.com</a></p>
				</div>
			</div>
		</div>
	</section>

	<!-- jQuery -->
	<script src="js/jquery.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="js/bootstrap.min.js"></script>

	<!-- Plugin JavaScript -->
	<script src="js/jquery.easing.min.js"></script>
	<script src="js/jquery.fittext.js"></script>
	<script src="js/wow.min.js"></script>

	<!-- Custom Theme JavaScript -->
	<script src="js/creative.js"></script>

	<script>
		$(document).ready(function () {
			//$('#saveDate').on('click', saveTheDateTime);
			$('#preViewWord').on('click', preViewWordFunc);
		});

		function preViewWordFunc() {
			localStorage.recodeWord = JSON.stringify(RecodeWord);
			$('#txtWord').attr('disabled', 'disabled');
			$('#preViewWordSection').fadeIn();
			dispayWriteWord();
		}

		function saveTheDateTime() {
			localStorage.theDate = txtTheDate.value;
		}

		//* Recode word **/
		var RecodeWord = [];
		var wordStartTime = new Date();
		$('#startWord').on('click', function () {
			saveTheDateTime();

			RecodeWord = [];
			wordStartTime = new Date();
			$('#txtWord').removeAttr('disabled').focus();
		});


		function wordInput(event) {
			var txtWordLength = $('#txtWord').val().length;
			$('#txtWord').next('span').text('(' + txtWordLength + '/100)');

			var theTimeAfterStart = new Date() - wordStartTime;


			var eachWordObj = { word: event.target.value, wordTime: theTimeAfterStart };

			RecodeWord.push(eachWordObj);

		}

		function dispayWriteWord() {
			var storageRecodeWord;
			try {
				storageRecodeWord = JSON.parse(localStorage.recodeWord);
			} catch (e) { }

			if (!storageRecodeWord || storageRecodeWord.length === 0) { alert('請重新輸入想說的話'); return false; }

			var canvas = document.getElementById("surfaceWriteWords");
			var ctx = canvas.getContext('2d');
			ctx.globalCompositeOperation = "copy";

			var lastWordTime = 0;
			var setTime = 0;
			$.each(storageRecodeWord, function (key, value) {


				if (value.wordTime - lastWordTime > 1000) {
					setTime += 1000;
				} else {
					setTime += value.wordTime - lastWordTime;
				}

				lastWordTime = value.wordTime;

				setTimeout(function () {
					ctx.save();
					ctx.font = "30px Arial";
					ctx.fillStyle = "rgba(256, 256, 256, 0.8)";

					var words = value.word.split('');
					var line = "";
					var line_y = 100;

					for (var n = 0; n < words.length; n++) {
						var testLine = line + words[n] + " ";
						var metrics = ctx.measureText(testLine);
						var testWidth = metrics.width;
						if (testWidth > 500 || words[n].indexOf("\n") > -1) {
							line = words[n] + " ";
							line_y += 40;
						}
						else {
							line = testLine;
						}
					}


					//ctx.fillText(value.word, 5, line_y);
					ctx.fillText(line, 5, line_y);
					ctx.restore();
				}, setTime)
			});
		}

		// drag
		function doDragStart(e) {
			e.originalEvent.target.style.opacity = '0.4';
			e.originalEvent.dataTransfer.setData("text/plain", e.target.id);
		}

		function doDragEnd(e) {
			e.originalEvent.target.style.opacity = '1.0';
		}

		function doDragOver(e) {
			e.preventDefault();
		}

		function doDragEnter(e) {
			$(this).addClass('dragOver');
			e.preventDefault();
		}
		function doDragLeave(e) {
			$(this).removeClass('dragOver')
			e.preventDefault();
		}

		function doDrop(e) {
			var sSourceId = e.originalEvent.dataTransfer.getData("text/plain");
			$(this).html($('#' + sSourceId));
			document.getElementById(sSourceId).style.opacity = "1.0";
			e.originalEvent.target.classList.remove("dragOver");
			e.preventDefault();
		}

		$('img')
            .on('dragstart', doDragStart)
            .on('dragend', doDragEnd);

		$('.dragTarget')
            .on('dragover', doDragOver)
            .on('dragenter', doDragEnter)
            .on('dragleave', doDragLeave)
            .on('drop', doDrop);

		function saveImg() {
			var chooseImgSrc = $('.dragTarget').find('img').attr('src');
			if (chooseImgSrc) {
				localStorage.chooseImgSrc = chooseImgSrc;
			}
		}

		function showLink() {
			$('#btn_exportCard').fadeOut();
		}

		function exportCard() {
			saveImg();

			if (!localStorage.theDate || !localStorage.recodeWord || !localStorage.chooseImgSrc) {
				var alertMsg = '';
				if (!localStorage.theDate) {
					alertMsg += '請輸入時間日期\n';
				}

				if (!localStorage.recodeWord) {
					alertMsg += '請輸入一段字\n';
				}

				if (!localStorage.chooseImgSrc) {
					alertMsg += '請選擇一張圖片\n';
				}

				alert(alertMsg);
				window.location = "#Start";
				return false;
			}

			if (!confirm('確定囉?')) {
				return false;
			}
		}

		$('#btn_exportCard').on('click', exportCard);


    </script>



</body>

</html>
